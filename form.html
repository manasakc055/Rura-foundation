<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CXO Registration</title>
  <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
</head>
<body>

<section class="py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
      <div class="w-full bg-white p-8 rounded-xl shadow-lg border border-gray-100 h-full">
        <form id="cxo-form" class="space-y-6">
          <!-- Personal Details -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Full Name</label>
            <input type="text" name="full_name" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="John Doe" required />
          </div>
          <div>
            <label class="block text-gray-700 font-medium mb-2">Contact Number</label>
            <input type="tel" name="contact_number" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="+91 9876543210" required />
          </div>
          <div>
            <label class="block text-gray-700 font-medium mb-2">Email Address</label>
            <input type="email" name="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="john@example.com" required />
          </div>
          
          <!-- Professional Details -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Are you an Entrepreneur, Student, or Working Professional?</label>
            <select id="profession" name="profession" class="w-full px-4 py-3 border border-gray-300 rounded-lg" required>
              <option value="">Select</option>
              <option value="entrepreneur">Entrepreneur</option>
              <option value="business_professional">Business Professional</option>
              <option value="student">Student</option>
              <option value="working_professional">Working Professional</option>
            </select>
          </div>

          <!-- Dynamic Fields -->
          <div id="dynamic-fields"></div>

          <!-- Why Interested -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Why are you interested in CXO Connect?</label>
            <textarea name="interest_reason" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg" required></textarea>
          </div>

          <!-- Areas of Interest -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Areas of Interest (Select at least one)</label>
            <div class="space-y-2">
              <label class="flex items-center"><input type="checkbox" name="interests" value="Networking" class="mr-2"> Networking</label>
              <label class="flex items-center"><input type="checkbox" name="interests" value="Funding & Investment" class="mr-2"> Funding & Investment</label>
              <label class="flex items-center"><input type="checkbox" name="interests" value="Business Networking" class="mr-2"> Business Networking</label>
            </div>
          </div>

          <!-- Speaker or Panelist -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Would you like to be a speaker, panelist, or share your startup journey?</label>
            <select name="speaker_option" id="speaker-option" class="w-full px-4 py-3 border border-gray-300 rounded-lg" required>
              <option value="no">No</option>
              <option value="yes">Yes</option>
            </select>
          </div>

          <div id="speaker-topic" class="hidden">
            <label class="block text-gray-700 font-medium mb-2">If Yes, Briefly Describe Your Topic</label>
            <textarea name="speaker_topic" rows="2" class="w-full px-4 py-3 border border-gray-300 rounded-lg"></textarea>
          </div>

          <!-- Preferred Mode of Attendance -->
          <div>
            <label class="block text-gray-700 font-medium mb-2">Preferred Mode of Attendance</label>
            <select name="attendance_mode" class="w-full px-4 py-3 border border-gray-300 rounded-lg" required>
              <option value="in-person">In-Person</option>
            </select>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="w-full bg-black text-white px-6 py-3 rounded-lg font-medium hover:bg-black/90 transition-all">Submit</button>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
// Handle profession-based dynamic fields
document.getElementById("profession").addEventListener("change", function() {
  const value = this.value;
  const dynamicFields = document.getElementById("dynamic-fields");
  dynamicFields.innerHTML = "";

  let fieldHtml = "";

  if (value === "entrepreneur") {
    fieldHtml = `
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Startup Name</label>
        <input type='text' name='startup_name' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Industry</label>
        <input type='text' name='startup_industry' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>`;
  } else if (value === "business_professional") {
    fieldHtml = `
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Business Name</label>
        <input type='text' name='business_name' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Type of Business</label>
        <input type='text' name='business_type' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>`;
  } else if (value === "student") {
    fieldHtml = `
      <div>
        <label class='block text-gray-700 font-medium mb-2'>College Name</label>
        <input type='text' name='college_name' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Course & Year</label>
        <input type='text' name='course_year' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>`;
  } else if (value === "working_professional") {
    fieldHtml = `
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Company Name</label>
        <input type='text' name='company_name' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>
      <div>
        <label class='block text-gray-700 font-medium mb-2'>Job Title</label>
        <input type='text' name='job_title' class='w-full px-4 py-3 border border-gray-300 rounded-lg' />
      </div>`;
  }

  dynamicFields.innerHTML = fieldHtml;
});

// Handle the speaker option visibility
document.getElementById("speaker-option").addEventListener("change", function() {
  const topicField = document.getElementById("speaker-topic");
  topicField.classList.toggle("hidden", this.value !== "yes");
});

// Form Submission
document.getElementById("cxo-form").addEventListener("submit", async function(event) {
  event.preventDefault();
  let formData = new FormData(this);
  let dataObject = {};

  formData.forEach((value, key) => {
    dataObject[key] = value;
  });

  // Handle multiple interests as an array
  let selectedInterests = [];
  document.querySelectorAll("input[name='interests']:checked").forEach(checkbox => {
    selectedInterests.push(checkbox.value);
  });
  dataObject.interests = JSON.stringify(selectedInterests);

  // Send data to Supabase
  const SUPABASE_URL = 'https://owzaetzxjsspqkwcucqg.supabase.co';
 const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93emFldHp4anNzcHFrd2N1Y3FnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA0MTc2MjcsImV4cCI6MjA1NTk5MzYyN30.fK9JpZ5XaBh2d0YZGgkcY4MJhZn9RQCujTp4G0J2hW8';
           

  try {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/cxo-registrations`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "apikey": SUPABASE_ANON_KEY,
        "Authorization": `Bearer ${SUPABASE_ANON_KEY}`,
      },
      body: JSON.stringify(dataObject),
    });

    if (response.ok) {
      window.location.href = "thank-you.html"; // Redirect on success
    } else {
      alert("Error submitting form. Please try again.");
    }
  } catch (error) {
    console.error("Error:", error);
    alert("Something went wrong.");
  }
});
</script>

</body>
</html>
